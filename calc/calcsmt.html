<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator SMT Reel</title>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            padding: 20px;
            margin: 0;
        }
        .card {
            border: 1px solid #ccc;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.252);
            background-color: #edeeff;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        select, input, button {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f4f4f4;
        }
        .footer {
            text-align: center;
            margin-top: 20px;
            color: #888;
        }

        /* Styling untuk link di dalam footer */
        .footer a.footer-link {
            color: #ffcc00;
            text-decoration: none;
            font-weight: bold;
            margin-left: 10px;
        }

        /* Hover effect */
        .footer a.footer-link:hover {
            text-decoration: underline;
            color: #ffffff;
        }
        #riwayatSection {
            display: none; /* Awalnya disembunyikan */
        }

        /* Media Queries untuk Responsiveness */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .card {
                padding: 15px;
                margin-bottom: 15px;
            }
            .form-group {
                margin-bottom: 10px;
            }
            select, input, button {
                padding: 6px;
            }
            table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
            th, td {
                padding: 6px;
            }
            th {
                font-size: 14px;
            }
            td {
                font-size: 14px;
            }
            .footer {
                font-size: 14px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 5px;
            }
            .card {
                padding: 10px;
                margin-bottom: 10px;
            }
            .form-group {
                margin-bottom: 5px;
            }
            select, input, button {
                padding: 4px;
            }
            table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
            th, td {
                padding: 4px;
            }
            th {
                font-size: 12px;
            }
            td {
                font-size: 12px;
            }
            .footer {
                font-size: 12px;
            }
        }

        /* Styling untuk tombol yang dipilih */
        .selected {
            background-color: #35ad1a; /* Warna gelap */
        }

        /* Styling untuk tombol */
        button {
            background-color: #000680;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:active {
            background-color: #010dec;
        }

        .custom-checkbox {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 16px;
            color: #000000; /* Text color for dark mode */
        }

        .custom-checkbox input {
            display: none; /* Hide the default checkbox */
        }

        .checkmark {
            width: 40px;
            height: 20px;
            background-color: #444; /* Background color for the toggle */
            border-radius: 20px;
            position: relative;
            transition: background-color 0.3s;
            margin-right: 10px; /* Space between checkbox and label */
        }

        .checkmark:after {
            content: "";
            position: absolute;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background-color: #ffffff; /* Circle color */
            top: 1px; /* Positioning the circle */
            left: 1px; /* Positioning the circle */
            transition: transform 0.3s; /* Animation for the toggle */
        }

        input:checked + .checkmark {
            background-color: #35ad1a; /* Color when checked */
        }

        input:checked + .checkmark:after {
            transform: translateX(20px); /* Move the circle to the right */
        }

        /* Styling untuk output fields */
        .output-field {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #edeeff; /* Warna latar belakang untuk output fields */
            color: #333; /* Warna teks untuk output fields */
            font-weight: bold; /* Teks tebal untuk output fields */
            pointer-events: none; /* Mencegah interaksi pengguna */
            user-select: none; /* Mencegah pengguna memilih teks */
        }


    </style>
</head>
<body>
    <h1>STOCK OPNAME SMT REEL</h1>

    <!-- Tombol Reset -->
    <div class="form-group">
        <button onclick="resetData()">Reset</button>
    </div>

    <!-- Lokasi dan Operator -->
    <div class="card">
        <div class="form-group">
            <label for="location_main">Lokasi:</label>
            <select id="location_main">
                <option value="SMT 1">SMT 1</option>
                <option value="SMT 2">SMT 2</option>
                <option value="SMT 3">SMT 3</option>
                <option value="RACK">RACK</option> <!-- Ganti SMT 4 menjadi RACK -->
            </select>
        </div>
        <!-- <div class="form-group">
            <label for="operator_main">Nama Operator:</label>
            <select id="operator_main">
                <option value="Rio">Rio</option>
                <option value="Budi">Budi</option>
                <option value="Albizar">Albizar</option>
                <option value="Agung">Agung</option>
            </select>
        </div> -->
        <div class="form-group">
            <label for="operator_main">Nama Operator:</label>
            <input type="text" id="operator_main" placeholder="Masukkan nama operator">
        </div>
        <div class="form-group">
            <button onclick="toggleListBox('paper')" id="paperButton">Paper</button>
            <button onclick="toggleListBox('embos')" id="embosButton">Embosh</button>
            <button onclick="toggleListBox('manual')" id="manualButton">Input Manual</button>
        </div>
        <div class="form-group">
            <label for="listBox1_main">BOX PAPER:</label>
            <input type="text" id="listBox1_main" list="options1" onchange="updateSelectedItem('listBox1_main')" disabled>
            <datalist id="options1">
                <!-- <option value="D0GA100JA023">
                <option value="D0GA101JA023">
                <option value="D0GA102JA023"> -->

                <option value="D0GA100JA023"></option>
                <option value="D0GA101JA023"></option>
                <option value="D0GA102JA023"></option>
                <option value="D0GA103JA023"></option>
                <option value="D0GA104JA023"></option>
                <option value="D0GA105JA023"></option>
                <option value="D0GA122JA023"></option>
                <option value="D0GA123JA023"></option>
                <option value="D0GA180JA023"></option>
                <option value="D0GA183JA023"></option>
                <option value="D0GA201JA023"></option>
                <option value="D0GA203JA023"></option>
                <option value="D0GA220JA023"></option>
                <option value="D0GA221JA023"></option>
                <option value="D0GA222JA023"></option>
                <option value="D0GA224JA023"></option>
                <option value="D0GA243JA023"></option>
                <option value="D0GA271JA023"></option>
                <option value="D0GA273JA023"></option>
                <option value="D0GA330JA023"></option>
                <option value="D0GA331JA023"></option>
                <option value="D0GA333JA023"></option>
                <option value="D0GA472JA023"></option>
                <option value="D0GA473JA023"></option>
                <option value="D0GA512JA023"></option>
                <option value="D0GA560JA023"></option>
                <option value="D0GA563JA023"></option>
                <option value="D0GA681JA023"></option>
                <option value="D0GA682JA023"></option>
                <option value="D0GA822JA023"></option>
                <option value="D0GAR00J0005"></option>
                <option value="D0GB100JA065"></option>
                <option value="D0GB101JA065"></option>
                <option value="D0GB102JA065"></option>
                <option value="D0GB102ZA028"></option>
                <option value="D0GB103JA065"></option>
                <option value="D0GB104JA065"></option>
                <option value="D0GB105JA065"></option>
                <option value="D0GB112JA065"></option>
                <option value="D0GB122JA065"></option>
                <option value="D0GB123JA065"></option>
                <option value="D0GB124JA065"></option>
                <option value="D0GB132JA065"></option>
                <option value="D0GB133JA065"></option>
                <option value="D0GB150JA065"></option>
                <option value="D0GB151JA065"></option>
                <option value="D0GB152JA065"></option>
                <option value="D0GB153JA065"></option>
                <option value="D0GB154JA065"></option>
                <option value="D0GB162JA065"></option>
                <option value="D0GB182JA065"></option>
                <option value="D0GB183JA065"></option>
                <option value="D0GB184JA065"></option>
                <option value="D0GB202JA007"></option>
                <option value="D0GB202JA065"></option>
                <option value="D0GB203JA065"></option>
                <option value="D0GB220JA065"></option>
                <option value="D0GB221JA065"></option>
                <option value="D0GB222JA065"></option>
                <option value="D0GB223JA065"></option>
                <option value="D0GB224JA065"></option>
                <option value="D0GB243JA065"></option>
                <option value="D0GB271JA065"></option>
                <option value="D0GB272JA065"></option> 
                <option value="D0GB273JA065"></option>
                <option value="D0GB2R2JA065"></option>
                <option value="D0GB303ZA028"></option>
                <option value="D0GB330JA065"></option>
                <option value="D0GB331JA065"></option>
                <option value="D0GB332JA065"></option>
                <option value="D0GB332ZA029"></option>
                <option value="D0GB333JA065"></option>
                <option value="D0GB334JA065"></option>
                <option value="D0GB3R3JA065"></option>
                <option value="D0GB431JA065"></option>
                <option value="D0GB470JA065"></option>
                <option value="D0GB471JA065"></option>
                <option value="D0GB472JA065"></option>
                <option value="D0GB472ZA028"></option>
                <option value="D0GB473JA065"></option>
                <option value="D0GB474JA065"></option>
                <option value="D0GB475JA065"></option>
                <option value="D0GB4R7JA065"></option>
                <option value="D0GB510JA065"></option>
                <option value="D0GB511JA065"></option>
                <option value="D0GB512JA065"></option>
                <option value="D0GB561JA065"></option>
                <option value="D0GB562JA065"></option>
                <option value="D0GB563JA065"></option>
                <option value="D0GB680JA065"></option>
                <option value="D0GB681JA065"></option>
                <option value="D0GB682JA065"></option>
                <option value="D0GB683JA065"></option>
                <option value="D0GB684JA065"></option>
                <option value="D0GB752JA065"></option>
                <option value="D0GB820JA065"></option>
                <option value="D0GB821JA065"></option>
                <option value="D0GB822JA065"></option>
                <option value="D0GB912ZA029"></option>
                <option value="D0GBR00J0004"></option>
                <option value="D0GB274JA065"></option>
                <option value="D0GD101JA052"></option>
                <option value="D0GD102JA052"></option>
                <option value="D0GD103JA052"></option>
                <option value="D0GD104JA052"></option>
                <option value="D0GD122JA052"></option>
                <option value="D0GD202JA052"></option>
                <option value="D0GD271JA052"></option>
                <option value="D0GD470JA052"></option>
                <option value="D0GD471JA052"></option>
                <option value="D0GD681JA052"></option>
                <option value="D0GD752JA052"></option>
                <option value="D0GDR00J0004"></option>
                <option value="D0GF101JA048"></option>
                <option value="D0GF102JA048"></option>
                <option value="D0GF102ZA002"></option>
                <option value="D0GF104JA048"></option>
                <option value="D0GF122JA048"></option>
                <option value="D0GF150JA048"></option>
                <option value="D0GF181JA048"></option>
                <option value="D0GF220JA048"></option>
                <option value="D0GF1R2JA048"></option>
                <option value="D0GF6R8JA048"></option>
                <option value="D0GF222JA048"></option>
                <option value="D0GF242ZA002"></option>
                <option value="D0GF243JA048"></option>
                <option value="D0GF271JA048"></option>
                <option value="D0GF301JA038"></option>
                <option value="D0GF333JA048"></option>
                <option value="D0GF334JA048"></option>
                <option value="D0GF360JA048"></option>
                <option value="D0GF364JA048"></option>
                <option value="D0GF622JA048"></option>
                <option value="D0GF681JA048"></option>
                <option value="D0GF751JA048"></option>
                <option value="D0GFR00J0005"></option>
                <option value="D0GG204JA039"></option>
                <option value="D0GL104J0001"></option>
                <option value="D0GR220JA022"></option>
                <option value="D0GZ104JA022"></option>
                <option value="D0GZ430JA022"></option>
                <option value="D0GZ751JA022"></option>
                <option value="D0YBR0000038"></option>
                <option value="D0YFR00J0002"></option>
                <option value="D1BA1002A023"></option>
                <option value="D1BA1003A023"></option>
                <option value="D1BA1502A023"></option>
                <option value="D1BA1302A023"></option>
                <option value="D1BA1800A023"></option>
                <option value="D1BA1802A022"></option>
                <option value="D1BA2002A023"></option>
                <option value="D1BA2701A023"></option>
                <option value="D1BA3001A023"></option>
                <option value="D1BA3002A023"></option>
                <option value="D1BA3301A022"></option>
                <option value="D1BA3301A023"></option>
                <option value="D1BA3903A022"></option>
                <option value="D1BA4302A023"></option>
                <option value="D1BA4702A022"></option>
                <option value="D1BA5101A022"></option>
                <option value="D1BA6803A022"></option>
                <option value="D1BA8661A023"></option>
                <option value="D1BA9101A023"></option>
                <option value="D1BB6202A073"></option>
                <option value="D1BB1002A073"></option>
                <option value="D1BB1002A074"></option>
                <option value="D1BB1003A073"></option>
                <option value="D1BB1003A074"></option>
                <option value="D1BB1004A073"></option>
                <option value="D1BB1202A073"></option>
                <option value="D1BB1211A073"></option>
                <option value="D1BB1211A141"></option>
                <option value="D1BB1302A073"></option>
                <option value="D1BB1501A073"></option>
                <option value="D1BB1502A073"></option>
                <option value="D1BB1503A074"></option>
                <option value="D1BB1600A073"></option>
                <option value="D1BB1802A073"></option>
                <option value="D1BB2002A073"></option>
                <option value="D1BB2002A074"></option>
                <option value="D1BB2201A073"></option>
                <option value="D1BB2203A074"></option>
                <option value="D1BB2402A073"></option>
                <option value="D1BB2433A074"></option>
                <option value="D1BB2700A073"></option>
                <option value="D1BB2702A074"></option>
                <option value="D1BB3001A073"></option>
                <option value="D1BB3002A073"></option>
                <option value="D1BB3002A074"></option>
                <option value="D1BB3301A073"></option>
                <option value="D1BB3301A074"></option>
                <option value="D1BB3601A073"></option>
                <option value="D1BB3902A073"></option>
                <option value="D1BB3921A073"></option>
                <option value="D1BB4222A073"></option>
                <option value="D1BB4301A074"></option>
                <option value="D1BB4302A074"></option>
                <option value="D1BB4702A073"></option>
                <option value="D1BB4702A074"></option>
                <option value="D1BB4751A073"></option>
                <option value="D1BB5101A074"></option>
                <option value="D1BB5102A073"></option>
                <option value="D1BB5492A073"></option>
                <option value="D1BB5621A073"></option>
                <option value="D1BB6801A073"></option>
                <option value="D1BB6802A073"></option>
                <option value="D1BB8201A073"></option>
                <option value="D1BB8202A073"></option>
                <option value="D1BB82R0A073"></option>
                <option value="D1BB8661A073"></option>
                <option value="D1BB9101A073"></option>
                <option value="D1BB9311A073"></option>
                <option value="D1BD8662A066"></option>
                <option value="D1BF1000A073"></option>
                <option value="D1BF1100A073"></option>
                <option value="D1BF2003A098"></option>
                <option value="D1BF4023A073"></option>
                <option value="D1BFR390A047"></option>
                <option value="D1BFR430A047"></option>
                <option value="D1BFR470A065"></option>
                <option value="D1BFR510A065"></option>
                <option value="D1BRR120A064"></option>
                <option value="D4CC11030018"></option>
                <option value="D4CC1103A038"></option>
                
                <option value="ERBRE0R50V"></option> <!-- D0GB -->
                <option value="ERJ3GEYJ132V"></option> <!-- D0GB DONE -->
                <option value="ERJ12YJ104U"></option> <!-- D0GZ DONE -->
                <!-- <option value="EVQPUL02K"></option> -->
                <option value="F1G0J105A063"></option>
                <option value="F1G1A104A026"></option>
                <option value="F1G1A1050004"></option>
                <option value="F1G1A475A099"></option>
                <option value="F1G1E104A078"></option>
                <option value="F1G1E105A186"></option>
                <option value="F1G1E224A193"></option> <!-- H,E,C DONE -->
                <option value="F1G1E225A183"></option> <!-- H,E,C DONE -->
                <option value="F1G1H101A807"></option>
                <option value="F1G1H102A830"></option>
                <option value="F1G1H102A548"></option>
                <option value="F1G1H103A548"></option>
                <option value="F1G1H103B104"></option>
                <option value="F1G1H121B065"></option>
                <option value="F1G1H152A548"></option>
                <option value="F1G1H221A548"></option>
                <option value="F1G1H223A548"></option>
                <option value="F1G1H272A548"></option>
                <option value="F1G1H330A807"></option>
                <option value="F1G1H332A548"></option>
                <option value="F1G1H471A548"></option>
                <option value="F1G1H471A807"></option>
                <option value="F1G1H5R0B062"></option>
                <option value="F1G1H821B065"></option>
                <option value="F1G1H2R2A982"></option>
                <option value="F1H0J1060003"></option>
                <option value="F1H1A1050040"></option>
                <option value="F1H1A154A046"></option>
                <option value="F1H1A334A159"></option>
                <option value="F1H1A474A046"></option>
                <option value="F1H1A475A102"></option>
                <option value="F1H1C103A107"></option>
                <option value="F1H1C104A107"></option>
                <option value="F1H1C105A107"></option>
                <option value="F1H1C105A167"></option>
                <option value="F1H1C225A215"></option>
                <option value="F1H1C334A107"></option>
                <option value="F1H1C823A107"></option> <!-- C,H DONE -->
                <option value="F1H1E104A086"></option>
                <option value="F1H1E1050009"></option>
                <option value="F1H1E224A086"></option>
                <option value="F1H1E224A161"></option>
                <option value="F1H1E273A002"></option>
                <option value="F1H1E473A086"></option>
                <option value="F1H1E475A205"></option>
                <option value="F1H1E683A086"></option>
                <option value="F1H1H100B043"></option>
                <option value="F1H1H1010014"></option>
                <option value="F1H1H102A842"></option>
                <option value="F1H1H102B047"></option>
                <option value="F1H1H103B047"></option>
                <option value="F1H1H103A842"></option>
                <option value="F1H1H104B047"></option>
                <option value="F1H1H120A860"></option>
                <option value="F1H1H122A013"></option>
                <option value="F1H1H150A004"></option>
                <option value="F1H1H151B043"></option>
                <option value="F1H1H152A842"></option>
                <option value="F1H1H153A842"></option>
                <option value="F1H1H180B043"></option>
                <option value="F1H1H1R0A016"></option>
                <option value="F1H1H200A831"></option>
                <option value="F1H1H220B043"></option>
                <option value="F1H1H221A004"></option>
                <option value="F1H1H222A842"></option>

                <option value="F1H1H223B047"></option>
                <option value="F1H1H270A004"></option>
                <option value="F1H1H272A842"></option>
                <option value="F1H1H330B043"></option>
                <option value="F1H1H331B043"></option>
                <option value="F1H1H332A842"></option>
                <option value="F1H1H333A842"></option>
                <option value="F1H1H3R0B170"></option>
                <option value="F1H1H471B043"></option>
                <option value="F1H1H472A842"></option>
                <option value="F1H1H4R0B170"></option>
                <option value="F1H1H561A219"></option>
                <option value="F1H1H5R0B170"></option>
                <option value="F1H1H682A842"></option>
                <option value="F1H1H6R0A016"></option>
                <option value="F1H1H7R0B091"></option>
                <option value="F1H1H822A842"></option>
                <option value="F1H1H8R0B091"></option>
                <option value="G1C68NJA0037"></option>
                <!-- <option value="G1C3R3MA0809"></option> -->
                <option value="G1C4R7MA1323"></option>
                <!-- <option value="G1C4R7MA0249"></option> -->
                <option value="G1CR12GA0007"></option>
                <option value="G1CR15K00017"></option>
                <option value="G1CR22GA0007"></option>
                <option value="H0J327200085"></option> <!-- BARU-->
                <!-- <option value="J0JBC0000019"></option> -->
                <option value="J0JYC0000051"></option> <!-- BARU-->
                <option value="J0JYC0000426"></option> <!-- BARU-->
                <option value="J0JYC0000251"></option> <!-- BARU-->

                <option value="K5H501Y00012"></option>
                <option value="G1C4R7K00013"></option> <!-- BARU-->
                <option value="F1J2E102A036"></option> <!-- BARU-->
            </datalist>
        </div>
        <div class="form-group">
            <label for="listBox2_main">BOX EMBOS:</label>
            <input type="text" id="listBox2_main" list="options2" onchange="updateSelectedItem('listBox2_main')" disabled>
            <datalist id="options2">
                <!-- List of options -->
                <option value="B0ACCK000005"></option> 
                <option value="B0ACCK000012"></option>
                <option value="B0ACCL000017"></option>
                <!-- <option value="B0ACDR000001"></option> -->
                <!-- <option value="B0BC7R4A0259"></option> -->
                <option value="B0BC8R1A0259"></option>
                <!-- <option value="B1ABMG000014"></option> -->  
                <option value="B0ADDH000009"></option>
                <option value="B0BC019A0007"></option>
                <option value="B0BC025A0245"></option>
                <!-- <option value="B0BC02900004"></option> --> 
                <option value="B0BC4R0A0006"></option>
                <option value="B0BC8R2A0908"></option> 
                <option value="B0ECKM000072"></option> <!-- BARU -->
                <!-- <option value="B0ECKP000099"></option> -->
                <option value="B0ECKR000089"></option>
                <!-- <option value="B0ECKT000009"></option> --> 
                <!-- <option value="B0ECKT000012"></option>  -->
                <!-- <option value="B0ECMR000030"></option> --> 
                <option value="B0ECKV000038"></option>
                <!-- <option value="B0EDKR000014"></option> --> 
                <!-- <option value="B0EDLU000001"></option> --> 
                <!-- <option value="B0JCCD000020"></option> --> 
                <!-- <option value="B0JCCD000041"></option> -->
                <option value="B0JCCE000003"></option>
                <option value="B0JCDD000046"></option>
                <option value="B0JCGE000020"></option>
                <option value="B0JCMA000003"></option>
                <option value="B0JCMC000006"></option>
                <option value="B0ECMM000009"></option>
                <option value="B0JCNC000008"></option>
                <option value="B0JCNE000039"></option>
                <option value="B0JCPL000020"></option> 
                <option value="B0ZBZ0000230"></option>
                <option value="B1ABAB000064"></option>
                <!-- <option value="B1ABCF000010"></option> -->
                <option value="B1ABCF000020"></option>
                <option value="B1ABCF000103"></option>
                <option value="B1ABCF000176"></option> <!-- BARU -->
                <option value="B1ADCE000012"></option>
                <option value="B1ADCF000020"></option>
                <option value="B1ADCF000063"></option>
                <option value="B1ADGD000004"></option>
                <option value="B1ADKD000009"></option> <!-- BARU -->
                <option value="B1ADMF000016"></option>
                <option value="B1ADND000007"></option> <!-- BARU -->
                <option value="B1CFHC000003"></option>
                <!-- <option value="B1CFQD000023"></option> --> 
                <option value="B1CHQD000014"></option>
                <!-- <option value="B1CHPB000012"></option> --> 
                <option value="B1GBCFEE0004"></option>
                <option value="B1GBCFGG0011"></option>
                <option value="B1GBCFGG0024"></option>
                <!-- <option value="B1GBCFGH0001"></option> --> 
                <option value="B1GBCFGJ0013"></option> <!-- BARU -->
                <option value="B1GBCFGJ0020"></option> <!-- BARU -->
                <!-- <option value="B1GBCFGN0019"></option> -->
                <option value="B1GBCFGN0022"></option> <!-- BARU -->
                <option value="B1GBCFJJ0002"></option> <!-- BARU -->
                <option value="B1GBCFJJ0040"></option> <!-- BARU -->
                <option value="B1GBCFJN0009"></option> <!-- BARU -->
                <option value="B1GBCFNA0016"></option> <!-- BARU -->
                <option value="B1GDCFGG0005"></option> <!-- BARU -->
                <option value="B1GDCFGG0028"></option> <!-- BARU -->
                <option value="B1GDCFGG0033"></option> <!-- BARU -->
                <!-- <option value="B1GDCFJJ0047"></option> --> 
                <option value="B1GDCFNA0011"></option> <!-- BARU -->
                <!-- <option value="B1GDCFNN0032"></option> -->
                <option value="B1GDCFGJ0010"></option> <!-- BARU -->
                <option value="B1GKCFJN0004"></option> <!-- BARU -->
                <!-- <option value="B1HBGFF00034"></option> --> 
                <!-- <option value="B1JBAR000001"></option> --> 
                <option value="B3AAB0000322"></option> <!-- BARU -->
                <!-- <option value="B3FBZ0000015"></option> -->
                <!-- <option value="B3PBA0000776"></option> --> 
                <!-- <option value="B3PBA0000778"></option> --> 
                <!-- <option value="B3PBA0000779"></option> --> 
                <!-- <option value="BU2305F-E2"></option> --> 
                <!-- <option value="C0CBABE00023"></option> --> 
                <!-- <option value="C0CBADE00023"></option> --> 
                <option value="C0DBAYY01511"></option> <!-- BARU -->
                <!-- <option value="C0DBAYY01639"></option> --> 
                <!-- <option value="C0DBAYY02696"></option> --> 
                <!-- <option value="C0DBAYY02861"></option> --> 
                <!-- <option value="C0DBAYY03403"></option> --> 
                <!-- <option value="C0DBBYY00090"></option> --> 
                <option value="C0DBGYY07463"></option>
                <option value="C0DBGYY07480"></option> <!-- BARU -->
                <option value="C0DBZMC00006"></option> <!-- BARU --> 
                <!-- <option value="C0DBZYY00531"></option> -->
                <!-- <option value="C0EBY0000631"></option> -->
                <option value="C0EBY0001278"></option> <!-- BARU -->
                <option value="C0EBY0002216"></option> <!-- BARU -->
                <option value="C0EBY0002221"></option> <!-- BARU -->
                <option value="C0EBY0002224"></option> <!-- BARU -->
                <option value="C0EBY0002225"></option> <!-- BARU -->
                <option value="C0EBY0002226"></option> <!-- BARU -->

                <!-- <option value="C0ZBZ0002094">-->
                <!-- <option value="C1AB00003764">-->
                <!-- <option value="C1AB00004021"> -->
                <!-- <option value="C1AB00004024"> -->
                <!-- <option value="C1AB00004405"> -->
                <!-- <option value="C1AB00004483"> -->
                <!-- <option value="C1AB00004511"> -->
                <!-- <option value="C1AB00004995"> -->
                <!-- <option value="C1BB00000947"> -->
                <!-- <option value="C1CB00005220"> -->
                <!-- <option value="C2BBYY000811"> -->
                <!-- <option value="C2BBYY002213"> -->
                <!-- <option value="C2CBYY001714"> -->
                <!-- <option value="C2CBYY003029"> -->
                <!-- <option value="C2CBYY002092"> -->
                <!-- <option value="C2CBYY002774"> -->
                <!-- <option value="C2CBYY002775"> -->
                <!-- <option value="C2DBYY001899"> -->
                <!-- <option value="C3EBHY000023"> -->
                <!-- <option value="C3FBLY000186"> -->
                
                <option value="B1GDCFJ10047"> <!-- BARU-->
                <option value="F1J0J106A102"> <!-- BARU-->
                <option value="F1J0J226A091"> <!-- BARU-->
                <option value="F1J1A106A146"> <!-- BARU-->
                <option value="F1J1C106A224"> <!-- BARU-->
                <option value="F1J1E105A171"> <!-- BARU-->
                <option value="F1J1E106A315"> <!-- BARU-->
                <option value="F1J1E334A161"> <!-- BARU-->
                <option value="F1J2E103A035"> <!-- BARU-->
                <option value="CODBAYY02861"> <!-- BARU-->
                <option value="F1K1E106A121"> <!-- BARU-->
                <option value="F1K1E106A167"> <!-- BARU-->
                <option value="F3F0G2270002"> <!-- BARU-->
                <option value="F3F0J107A064"> <!-- BARU-->
                <option value="F3F0J1570001"> <!-- BARU-->
                <option value="F3F0J4760004"> <!-- BARU-->
                <option value="J0ZZB0000238"></option> <!-- BARU-->
                <option value="H0J120500096"></option>
                <option value="H0J384500009"></option>
                <option value="RLQM1R0MT-M"></option>
                <option value="RLQM2R2MT-M"></option>
                <option value="D4FB1R100015"></option> <!-- NOTE -->
                <option value="C0DBGYY000919"></option> <!-- BARU -->
                <option value="C0JBAR000699"></option> <!-- BARU -->
                <option value="C0DBGYY02678"></option> <!-- BARU -->
                <option value="C0DBGYY02049"></option> <!-- BARU -->
            </datalist>
        </div>
        <div class="form-group">
            <label for="manualInput_main">INPUT MANUAL:</label>
            <input type="text" id="manualInput_main" onchange="updateSelectedItem('manualInput_main')" disabled>
        </div>
        <div class="form-group">
            <label for="selectedItem_main">Selected Item:</label>
            <input type="text" id="selectedItem_main" class="output-field" readonly>
        </div>
    </div>

    <!-- Jarak Diameter Dalam dengan Luar -->
    <div class="card">
        <div class="form-group">
            <label class="custom-checkbox">
                <input type="checkbox" id="bypassCalculation" onchange="toggleBypassCalculation()">
                <span class="checkmark"></span>
                Aktifkan Jika Roll kondisi baru (Matikan Jika Roll Sudah terpakai)
            </label>
        </div>
        <div class="form-group">
            <label for="jarak_main">Jarak Diameter Dalam dengan Luar:</label>
            <input type="number" id="jarak_main" oninput="hitungHasil()">
        </div>
        <div class="form-group">
            <label for="hasilPerhitungan_main">Hasil Perhitungan:</label>
            <input type="text" id="hasilPerhitungan_main" class="output-field" readonly>
        </div>
        <div class="form-group">
            <button onclick="tambahKeTabel()">Tambah ke Tabel</button>
        </div>
    </div>

    <!-- Tabel Input -->
    <div class="card">
        <h2>Tabel Input:</h2>
        <table id="tabelInput">
            <thead>
                <tr>
                    <th>Nama Komponen</th>
                    <th>Operator</th>
                    <th>Mesin</th>
                    <th>Hasil</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data akan ditambahkan di sini -->
            </tbody>
        </table>
        <div class="form-group">
            <label for="total_main">Total:</label>
            <input type="text" id="total_main" readonly>
        </div>
    </div>

    <!-- Tombol Riwayat -->
    <div class="card">
        <button onclick="showRiwayat()">Riwayat Komponen</button>
    </div>

    <!-- Bagian Riwayat (awalnya tersembunyi) -->
    <div id="riwayatSection" class="card">
        <h2>Riwayat Komponen</h2>
        <!-- Lokasi -->
        <div class="form-group">
            <label for="location_riwayat">Lokasi:</label>
            <select id="location_riwayat" onchange="filterData()">
                <option value="all">Semua</option>
                <option value="SMT 1">SMT 1</option>
                <option value="SMT 2">SMT 2</option>
                <option value="SMT 3">SMT 3</option>
                <option value="RACK">RACK</option> <!-- Ganti SMT 4 menjadi RACK -->
            </select>
        </div>

        <!-- Tabel Riwayat -->
        <h2>Riwayat Input:</h2>
        <div style="max-height: 300px; overflow-y: auto;"> <!-- Div untuk scroll -->
            <table id="tabelRiwayat">
                <thead>
                    <tr>
                        <th>Tanggal</th>
                        <th>Nama Komponen</th>
                        <th>Operator</th>
                        <th>Mesin</th>
                        <th>Hasil</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Data akan ditambahkan di sini -->
                </tbody>
            </table>
        </div>
        <div class="form-group">
            <button onclick="exportToExcel()">Export Riwayat</button>
            <button onclick="exportTotal()">Export Total</button>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
    <p>© 2025 PENS - Panasonic Collaboration </p>
        <a href="../Panduan/panduan.html" class="footer-link">Buku Panduan Digital</a>
    </div>

    <!-- Library SheetJS untuk export Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <script>
        let tableData = {};
        let komponenTotal = {};
        let historyData = {
            'SMT 1': {},
            'SMT 2': {},
            'SMT 3': {},
            'RACK': {}, // Ganti SMT 4 menjadi RACK
        };

        let selectedItem = 'SMT 1';
        let selectedOperator = 'Rio';
        let selectedListBox1Item = null;
        let selectedListBox2Item = null;
        let isListBox1Active = false;
        let isListBox2Active = false;

        document.addEventListener('DOMContentLoaded', () => {
            loadDataMain();
        });

        function loadDataMain() {
            const tableDataString = localStorage.getItem('tableData');
            const komponenTotalString = localStorage.getItem('komponenTotal');
            const historyDataString = localStorage.getItem('historyData');

            if (tableDataString && komponenTotalString && historyDataString) {
                tableData = JSON.parse(tableDataString);
                komponenTotal = JSON.parse(komponenTotalString);
                historyData = JSON.parse(historyDataString);
                renderTable();
                updateTotal();
                renderTableRiwayat();
            }
        }

        function toggleListBox(type) {
        const paperButton = document.getElementById('paperButton');
        const embosButton = document.getElementById('embosButton');
        const manualButton = document.getElementById('manualButton');

        if (type === 'paper') {
            isListBox1Active = true;
            isListBox2Active = false;
            document.getElementById('listBox1_main').disabled = false;
            document.getElementById('listBox2_main').disabled = true;
            document.getElementById('manualInput_main').disabled = true;
            document.getElementById('listBox2_main').value = '';
            document.getElementById('manualInput_main').value = '';
            selectedListBox2Item = null;
            selectedManualInput = null;
            paperButton.classList.add('selected');
            embosButton.classList.remove('selected');
            manualButton.classList.remove('selected');
        } else if (type === 'embos') {
            isListBox1Active = false;
            isListBox2Active = true;
            document.getElementById('listBox1_main').disabled = true;
            document.getElementById('listBox2_main').disabled = false;
            document.getElementById('manualInput_main').disabled = true;
            document.getElementById('listBox1_main').value = '';
            document.getElementById('manualInput_main').value = '';
            selectedListBox1Item = null;
            selectedManualInput = null;
            paperButton.classList.remove('selected');
            embosButton.classList.add('selected');
            manualButton.classList.remove('selected');
        } else if (type === 'manual') {
            isListBox1Active = false;
            isListBox2Active = false;
            document.getElementById('listBox1_main').disabled = true;
            document.getElementById('listBox2_main').disabled = true;
            document.getElementById('manualInput_main').disabled = false;
            document.getElementById('listBox1_main').value = '';
            document.getElementById('listBox2_main').value = '';
            selectedListBox1Item = null;
            selectedListBox2Item = null;
            paperButton.classList.remove('selected');
            embosButton.classList.remove('selected');
            manualButton.classList.add('selected');
        }
        updateSelectedItem();
    }

    let selectedManualInput = null;

    function updateSelectedItem(listBoxId = null) {
        if (listBoxId === 'listBox1_main' && isListBox1Active) {
            selectedListBox1Item = document.getElementById('listBox1_main').value;
            selectedListBox2Item = null;
            selectedManualInput = null;
        } else if (listBoxId === 'listBox2_main' && isListBox2Active) {
            selectedListBox2Item = document.getElementById('listBox2_main').value;
            selectedListBox1Item = null;
            selectedManualInput = null;
        } else if (listBoxId === 'manualInput_main') {
            selectedManualInput = document.getElementById('manualInput_main').value;
            selectedListBox1Item = null;
            selectedListBox2Item = null;
        }
        document.getElementById('selectedItem_main').value = selectedListBox1Item || selectedListBox2Item || selectedManualInput || '';
        hitungHasil();
    }
        function toggleBypassCalculation() {
            const bypassCheckbox = document.getElementById('bypassCalculation');
            const jarakInput = document.getElementById('jarak_main');
            const hasilInput = document.getElementById('hasilPerhitungan_main');
            const selectedItem = document.getElementById('selectedItem_main').value;

            if (bypassCheckbox.checked) {
                jarakInput.disabled = true;

                    //Total Komponen 3000
                    const predefinedValues = Object.fromEntries([
                    'B0ACCK000005', 'B0ACCK000012', 'B0ACCL000017', 'B0BC7R4A0259', 'B0BC8R1A0259', 'B0ADDH000009',
                    'B0BC02900004', 'C0EBY0001524', 'B1ABCF000176', 'B1GDCFJ10047', 'F1J1E334A161', 'C0DBZMC00006',
                    'F3F0J107A064', 'F3F0G2270002', 'J0ZZB0000238', 'B0JCPL000020', 'B1GBCFJJ0002', 'BOADDH000009',
                    'B08C019A0007', 'BOBC4R0A0006', 'BOBC8R1A0259', 'BOJCGE000020', 'BOJCMA000003', 'COZBZ0002868',
                    'BOJCCD000041', 'BOJCMC000006', 'BOJCNC000008', 'BOJCNE000039', 'C0EBY0000661', 'B1ABCF000010',
                    'B1ABCF000103', 'B1ADCF000020', 'B1ADCE000012', 'B1ADCF000063', 'BOJCCE000008', 'B1CFHC000003',
                    'B1CHQD000014', 'B1GBCFEE0004', 'B1GBCFGG0011', 'B1GBCFGG0024', 'B1GBCFGN0022', 'B1GBCFJJ0040',
                    'B1GDCFGG0028', 'CODBAYY01511', 'CODBGYY02044', 'CODBGYY02049', 'COEBY0001278', 'COEBY0002224',
                    'COEBY0002225', 'COEBY0002226', 'COJBAR000699', 'H0J327200085', 'RLQM1R0MT-M', 'RLQM2R2MT-M',
                    'C0DBGYY000919', 'B3AAB0000322', 'B1GKCFJN0004', 'B1GBCFJN0009', 'C0JBAR000699','C0EBY0000631',
                    'B1GBCFGJ0020', 'B1GDCFGG0005', 'C0DBAYY01511', 'C0DBGYY02049', 'C0EBY0001278', 'C0EBY0002221',
                    'B0ACDR000001', 'B0ADDH000004', 'D0GB102ZA028', 'B0BC7R500001', 'B0BC8R2A0908', 'B0BC9R000008',
                    'B0CAAB000020', 'B0CDAB000019', 'B0CDAE000002', 'B0CDBB000020', 'B0CDGB000001', 'B0EAKM000103',
                    'B0EAKM000173', 'B0EAKM000198', 'B0EAKP000180', 'B0EAKR000195', 'B0EAKT000066', 'B0EAMM000039',
                    'B0ECKM000072', 'B1AAJC000021', 'B1ABAC000022', 'B1ABBB000056', 'B1ABDF000017', 'B1ABDF000026',
                    'B1ABGB000026', 'B1ABHC000001', 'B1ACNF000026', 'B1ADCF000001', 'B1ADCF000086', 'B1ADGD000004',
                    'B1ADJB000005', 'B1ADKB000008', 'B1ADMB000003', 'B1BCCD000019', 'B1BCCF000026', 'B1CFCB000017',
                    'B1CFHC000011', 'B1CFQD000011', 'B1CFQD000023', 'B1CHNC000018', 'B1CHPB000005', 'B1CHPB000012',
                    'B1DEDQ000025', 'B1DFDD000019', 'B1DHCD000034', 'B1GACFJJ0006', 'B1GACFYY0006', 'B1GBCFAN0001',
                    'B1GBCFGH0001', 'B1GBCFGJ0013', 'B1GBCFJA0005', 'B1GBCFJN0001', 'B1GBCFJN0033', 'B1GBCFNA0001',
                    'B1GBCFNN0009', 'B1GBCFNN0015', 'B1GBCFQA0008', 'B1GBCFYY0321', 'B1GDCFGG0033', 'B1GDCFGJ0010',
                    'B1GDCFJA0013', 'B1GDCFJJ0008', 'B1GDCFJJ0042', 'B1GDCFJN0001', 'B1GDCFNA0006', 'B1GDCFNA0010',
                    'B1GDCFNN0007', 'B1GDCFNN0032', 'B1GFCFGA0003', 'B1GKCFNN0006', 'B1HBBBA00002', 'B1HBECA00004',
                    'B0BC01200019', 'B0BC013A0007', 'B0BC019A0007', 'B0BC025A0245', 'B0BC5R000009', 'B0BC5R600003',
                    'B0BC6R2A0380', 'B3ADB0000047', 'B3FBZ0000015', 'B3PBA0000776', 'B3PBA0000778', 'B3PBA0000779',
                    'B3PBC0000031', 'C0CBAAC00167', 'C0CBABE00023', 'C0CBABE00040', 'C0CBADE00023', 'C0CBCDH00001',
                    'C0DAEZZ00003', 'C0DBEKG00003', 'C0DBFYY00164', 'C0DBGYY00330', 'C0DBGYY00662', 'C0DBGYY00915',
                    'C0DBGYY00919', 'C0DBGYY03303', 'C0DBGYY03319', 'C0DBGYY04113', 'C0DBZYY00531', 'C0EAB0000010',
                    'C0EBA0000016', 'C0EBC0000033', 'C0EBE0000106', 'C0EBE0000122', 'C0EBE0000124', 'C0EBG0000366',
                    'C0EBM0000024','F1J2E103A035' , 'F1J1E105A171'
                    ].map(key => [key, 3000])

                    //Total Komponen 16000
                    .concat(['D1BRR120A064'].map(key => [key, 16000]))

                    //Total Komponen 15000
                    .concat(['B1ABAB000064'].map(key => [key, 15000]))


                    //Total Komponen 10000
                    .concat([
                    'J0JYC0000051','J0JYC0000426','D0GA101JA023','D0GA1021A023','D0GA103JA023',
                    'D0GA1041A023','D0GA222JA023','D0GAR00J0005','F1G1A104A026','F1G1E104A078', 
                    'F1G1E105A186','F1G1E225A183','F1G1H101A807','F1G1H102A548','F1G1H103A548',
                    'F1G1H330A807','F1G1H821B065','F1G1H471A548','D1BA1002A023','D1BA3301A022',
                    'D1BA3301A023','D1BA8661A023','D0GA104JA023','D0GA100JA023','D0GA102JA023',
                    'D0GA106JA023','D0GA124JA023','D0GA150JA023','D0GA151JA023','D0GA152JA023',
                    'D0GA153JA023','D0GA154JA023','D0GA184JA023','D0GA220JA023','D0GA223JA023',
                    'D0GA225JA023','D0GA243JA023','D0GA244JA023','D0GA270JA023','D0GA271JA023',
                    'D0GA272JA023','D0GA274JA023','D0GA2R2JA023','D0GA330JA023','D0GA331JA023',
                    'D0GA332JA023','D0GA333JA023','D0GA334JA023','D0GA391JA023','D0GA392JA023',
                    'D0GA393JA023','D0GA394JA023','D0GA470JA023','D0GA471JA023','D0GA473JA023',
                    'D0GA474JA023','D0GA4R7JA023','D0GA512JA023','D0GA561JA023','D0GA562JA023',
                    'D0GA681JA023','D0GA683JA023','D0GA684JA023','D0GA823JA023','D1BA1502A023',
                    'D1BA2002A023','B0BA039A0553','B0ACCK000003','B0ACDR000001','B0ADBD000005',
                    'B0ADFJ000004','B3ABA0000483','F1G0J105A063'
                    ].map(key => [key, 10000]))

                    //Total Komponen 8000
                    .concat([
                    'B0JCDD000046','B1GBCFNA0016','B1GDCFNA0011','B1GBCFJN0040','B1GBCFLN0015',
                    'B1GBCFNA0016','B1GDCFNA0011','B1GDCFNN0032'
                    ].map(key => [key, 8000]))
                    

                    //Total Komponen 7500
                    .concat(['B0ECKT000009'].map(key => [key, 7500]))


                    //Total Komponen 5000
                    .concat([
                    'COEBY0002216', 'D0GB100JA065', 'D0GB101JA065', 'D0GB102JA065', 'D0GB103JA065', 
                    'D0GB104JA065', 'D0GB112JA065', 'D0GB122JA065', 'D0GB132JA065', 'D0GB133JA065', 'D0GB150JA065', 
                    'D0GB152JA065', 'D0GB153JA065', 'D0GB182JA065', 'D0GB183JA065', 'D0GB184JA065', 'D0GB202JA007', 
                    'D0GB203JA065', 'D0GB221JA065', 'D0GB222JA065', 'D0GB271JA065', 'D0GB331JA065', 
                    'D0GB332JA065', 'D0GB333JA065', 'D0GB471JA065', 'D0GB472JA065', 'D0GB473JA065', 'D0GB474JA065', 
                    'D0GB475JA065', 'D0GB4R7JA065', 'D0GB511JA065', 'D0GB512JA065', 'D0GB561JA065', 'D0GB681JA065', 
                    'D0GB682JA065', 'D0GB684JA065', 'D0GB821JA065', 'D0GD103JA052', 'D0GBR00J0004', 'D0GD104JA052', 
                    'D0GD470JA052', 'D0GD752JA052', 'D0GDR00J0004', 'D0GF102ZA002', 'D0GF102JA048', 'D0GB332ZA029', 
                    'D0GF101JA048', 'D0GF243JA048', 'D0GB162JA065', 'D0GZ204JA022', 'K5H501Y00012', 'D1BB1503A074', 
                    'D1BB2002A073', 'D1BB2002A074', 'D1BB2201A073', 'D1BB2203A074', 'D1BB2433A074', 'D1BB3002A074', 
                    'D1BB4302A074', 'D1BB4702A073', 'D1BB4702A074', 'D1BB4751A073', 'D1BB5621A073', 'D1BB6802A073', 
                    'D1BF1100A073', 'D1BF4023A073', 'D0GF104JA048', 'D0GF122JA048', 'D0GF181JA048', 'D0GF222JA048', 
                    'D0GF242ZA002', 'D0GF301JA038', 'D0GF333JA048', 'D0GF360JA048', 'D0GF751JA048', 'D0GFR00J0005',  
                    'D0GZ430JA022', 'D0GZ751JA022', 'D1BB1002A074', 'D1BB1002A073', 'C0EBY0002216', 'D0GA105JA023',
                    'D0GA122JA023', 'D0GA123JA023', 'D0GA180JA023', 'D0GA183JA023', 'D0GA201JA023', 'D0GA203JA023',
                    'D0GA221JA023', 'D0GA224JA023', 'D0GA273JA023', 'D0GA472JA023', 'D0GA560JA023', 'D0GA563JA023',
                    'D0GA682JA023', 'D0GA822JA023', 'D0GB100JA057', 'D0GB101JA057', 'D0GB102JA057', 'D0GB103JA057',
                    'D0GB104JA065', 'D0GB105JA057', 'D0GB105JA065', 'D0GB112JA065', 'D0GB122JA065', 'D0GB123JA065',
                    'D0GB124JA065', 'D0GB133JA065', 'D0GB151JA057', 'D0GB151JA065', 'D0GB155JA065', 'D0GB181JA065',
                    'D0GB202JA057', 'D0GB203JA065', 'D0GB220JA065', 'D0GB222JA057', 'D0GB223JA065', 'D0GB224JA065',
                    'D0GB225JA065', 'D0GB240JA065', 'D0GB243JA057', 'D0GB272JA065', 'D0GB273JA057', 'D0GB274JA065',
                    'D0GB2R2JA065', 'D0GB302JA065', 'D0GB303ZA028', 'D0GB330JA065', 'D0GB331JA065', 'D0GB332ZA029',
                    'D0GB333JA065', 'D0GB334JA065', 'D0GB335JA065', 'D0GB391JA065', 'D0GB392JA065', 'D0GB393JA065',
                    'D0GB394JA065', 'D0GB3R3JA065', 'D0GB431JA065', 'D0GB470JA065', 'D0GB472ZA028', 'D0GB475JA065',
                    'D0GB510JA065', 'D0GB511JA057', 'D0GB512JA065', 'D0GB560JA065', 'D0GB561JA065', 'D0GB562JA065',
                    'D0GB563JA065', 'D0GB5R6JA065', 'D0GB680JA065', 'D0GB681JA065', 'D0GB683JA065', 'D0GB684JA065',
                    'D0GB6R8JA065', 'D0GB752JA065', 'D0GB820JA057', 'D0GB820JA065', 'D0GB821JA065', 'D0GB822JA065',
                    'D0GB823JA065', 'D0GB824JA065', 'D0GB912ZA029', 'D0GB914JA065', 'D0GD101JA017', 'D0GD101JA052',
                    'D0GD101JA055', 'D0GD102JA052', 'D0GD102JA055', 'D0GD103JA055', 'D0GD104JA055', 'D0GD122JA052',
                    'D0GD183JA017', 'D0GD202JA052', 'D0GD224JA017', 'D0GD271JA052', 'D0GD331JA055', 'D0GD471JA052',
                    'D0GD472JA055', 'D0GD4R7JA017', 'D0GD621JA052', 'D0GD681JA052', 'D0GD752JA052', 'D0GDR00JA055',
                    'D0GF104JA049', 'D0GF122JA048', 'D0GF152JA048', 'D0GF181JA048', 'D0GF220JA048', 'D0GF222JA049',
                    'D0GF271JA049', 'D0GF334JA048', 'D0GF360JA049', 'D0GF364JA048', 'D0GF4R7JA048', 'D0GF622JA048',
                    'D0GF681JA048', 'D0GG204JA039', 'D0GZ104JA022', 'D0YBR0000020', 'D0YBR0000038', 'D0YFR0000020',
                    'D0YFR00J0002', 'D1AC1400A094', 'D1AC1690A094', 'D1AC1800A094', 'D1AC2200A094', 'D1BA1003A023',
                    'D1BA1302A023', 'D1BA1800A023', 'D1BA1802A022', 'D1BA2701A023', 'D1BA3001A023', 'D1BA3002A023',
                    'D1BA3301A022', 'D1BA3903A022', 'D1BA4302A023', 'D1BA4702A022', 'D1BA5101A022', 'D1BA6041A023',
                    'D1BA6803A022', 'D1BB10020004', 'D1BB10030002', 'D1BB1003A074', 'D1BB1004A073', 'D1BB1202A073',
                    'D1BB13020002', 'D1BB15010002', 'D1BB1502A073', 'D1BB1503A074', 'D1BB1504A073', 'D1BB1600A010',
                    'D1BB1600A073', 'D1BB1802A073', 'D1BB1803A073', 'D1BB2001A073', 'D1BB2002A074', 'D1BB2202A073',
                    'D1BB2203A074', 'D1BB2402A073', 'D1BB2433A074', 'D1BB2702A074', 'D1BB3001A010', 'D1BB3002A010',
                    'D1BB3002A074', 'D1BB33010002', 'D1BB3301A011', 'D1BB3301A074', 'D1BB3601A010', 'D1BB3601A073',
                    'D1BB3901A073', 'D1BB3902A074', 'D1BB4301A011', 'D1BB4301A074', 'D1BB4302A074', 'D1BB4702A074',
                    'D1BB4751A073', 'D1BB5101A011', 'D1BB5102A010', 'D1BB5492A073', 'D1BB5601A073', 'D1BB5603A073',
                    'D1BB5621A073', 'D1BB6202A073', 'D1BB6801A073', 'D1BB6802A073', 'D1BB8201A073', 'D1BB8202A073',
                    'D1BB8203A073', 'D1BB82R0A010', 'D1BB82R0A073', 'D1BB8661A010', 'D1BB8661A073', 'D1BB9101A010',
                    'D1BB9101A073', 'D1BB9311A073', 'D1BD8662A066', 'D1BF1000A067', 'D1BF1000A073', 'D1BF1100A067',
                    'D1BF2003A064', 'D1BF2003A098', 'D1BF4023A067', 'D1BFR510A065', 'B0AAFK000004', 'B0BA01100097',
                    'B0BA01400062', 'B0BA036A0480', 'B0BA3R100004', 'B0BA4R000003', 'B0BA4R000012', 'B0BA5R000004',
                    'B0BA5R100048', 'B0BA6R2A0477', 'B0BA6R2A0479', 'B0BA6R600008', 'B0BA6R800025', 'B0BA8R700009',
                    'B0BA9R600002', 'B0BA9R600016', 'B0EAKM000126', 'B0EAKM000171'
                    ].map(key => [key, 5000]))

                    //Total Komponen 4000
                    .concat([
                    'F1H1E104A086', 'F1H1E224A161', 'F1H1E473A086', 'C3FBKY000139', 'F1J2E102A036',
                    'F1H1H100B043', 'F1H1H102B047', 'F1H1H103A842', 'F1H1H103B047', 'F1H1H104B047',
                    'F1H1H122A013', 'F1H1H220B043', 'F1H1H221A004', 'F1H1H223A842', 'F1H1H270A004',
                    'F1H1H330B043', 'F1H1H332A842', 'F1H1H333A842', 'F1H1H471B043', 'F1H1H472A842',
                    'F1H1C8230002', 'F1H1H682A842', 'G1C4R7MA1323', 'F1H1A1050040', 'F1H1A475A102',
                    'F1H1A474A046', 'F1H1C104A107', 'F1H1C105A107', 'G1CR15K00017', 'J0JYC0000251',
                    'D1BRR120A064', 'G1C4R7K00013', 'D0GL104J0001', 'D0GR220JA022', 'C0FBBY000073',
                    'F1H0J1060003'
                    ].map(key => [key, 4000]))

                    //Total Komponen 2500
                    .concat([
                    'B1HBGFF00034', 'B1JBAR000001', 'C0DBAYY03403', 'C0DBAYY01729', 'C0DBAYY02861',
                    'C0DBBYY00090', 'C0DBEYY00271', 'C0ZBZ0002094', 'C1AB00004151', 'C1AB00004157',
                    'C1AB00004210', 'C1AB00004211', 'C1AB00004483', 'C1AB00004511', 'C1BB00000947',
                    'C1CB00004533', 'C2BBYY000811', 'C3EBDG000052'
                    ].map(key => [key, 2500]))


                    //Total Komponen 2000
                    .concat([
                    'B1ADKD000009', 'F3F0J4760004', 'F1J1C106A224', 'F1J1E106A315', 'F1J0J106A102',
                    'F1J0J226A091', 'F1J1A106A146', 'F1K1E106A121', 'F1K1E106A167', 'BOECKV000038',
                    'ECEA1EKA4R7I', 'B0BA027A0463', 'B0BA170A0554', 'B0BA180A0554', 'B1ZBZ0000005',
                    'B0BB14500006', 'B0EAKM000117', 'B0ECKV000038', 'B1HBGFF00014', 'B1HBGFF00026',
                    'B3AAA0000573', 'B3AAA0000608', 'B3AAA0000721', 'B3AAA0001276', 'B3AAA0001354',
                    'B3ABA0000789', 'B3ABB0000086', 'B3ACA0000220', 'B3ADA0000161', 'B3AEA0000049',
                    'B3AFA0000161', 'C0ABBB000228', 'C0ABBB000432', 'C0BBBA000022', 'C0DBAYY02696',
                    'C0DBGYY07463', 'C0JBAS000349', 'C1AB00002553', 'C1AB00002554', 'C1AB00003566',
                    'C1AB00003764', 'C1AB00004405', 'C1BB00000496', 'C1BB00000732', 'C1BB00000757',
                    'C1BB00000763', 'C1BB00001070'
                    ].map(key => [key, 2000]))

                    //Total Komponen 1800
                    .concat([
                    'BOECKR000089', 'BOECMM000009', 'B0ECKP000099', 'B0ECKR000089', 'B0ECKT000012',
                    'B0ECMM000009'
                    ].map(key => [key, 1800]))

                    //Total Komponen 1300
                    .concat(['B0CDBB000019','B0CDGC000001'].map(key => [key, 1300]))

                    //Total Komponen 1280
                    .concat(['C2CBYY001835'].map(key => [key, 1280]))

                    //Total Komponen 1000
                    .concat([
                    'CODBGYY02678', 'CODBGYY07480', 'C0DBGYY07480', 'D0GB162JA065', 'D0GF101JA048',
                    'D0GF150JA048', 'D0GF1R2JA048', 'D0GF243JA048', 'D0GF6R8JA048', 'D1BB1211A073',
                    'D1BB1211A141', 'D1BB2700A073', 'D1BB3921A073', 'D1BB4222A073', 'D1BFR390A047',
                    'D1BFR430A047', 'D1BFR470A065', 'B0BA036A0447', 'B1ABMG000014', 'B1ADMF000017',
                    'B1ADND000007', 'B3AAA0001360', 'B3ACA0000264', 'B3PAA0000695', 'B3AFA0000145',
                    'C0CBABC00115', 'C0CBADC00072', 'C0DBGYY02678', 'C1AB00003976', 'C1AB00004021',
                    'C1AB00004024', 'C1BB00001120', 'C2CBYY000956', 'C2CBYY001558', 'C2CBYY001714'
                        ].map(key => [key, 1000]))

                    //Total Komponen 960
                    .concat(['C0HBA0000268'].map(key => [key, 960]))

                    //Total Komponen 952
                    .concat(['C2CBYY002434','C2CBYY002774'].map(key => [key, 952]))

                    //Total Komponen 720
                    .concat(['C2CBYY002317'].map(key => [key, 720]))

                    //Total Komponen 600
                    .concat(['B0CAAB000001'].map(key => [key, 600]))


                    //Total Komponen 500
                    .concat(['B0EAMM000038','B3AAA0000778','B3AAA0001371','C0DAEJG00001',
                    'C2FBYY000008','C3EBHY000023'
                    ].map(key => [key, 500]))
                    
                    //Total Komponen 450
                    .concat(['C2HBCY000112'].map(key => [key, 450]))

                    //Total Komponen 360
                    .concat(['B3BA4F000003'].map(key => [key, 360]))

                    //Total Komponen 350
                    .concat(['C2FBYY000007'].map(key => [key, 350]))

                    //Total Komponen 330
                    .concat(['C2CBYY000921'].map(key => [key, 330]))

                    //Total Komponen 280
                    .concat(['B3BB4H000003','B3BB4H000007'].map(key => [key, 280]))

                    //Total Komponen 200
                    .concat(['B3RAB0000121','B3RAD0000071'].map(key => [key, 200]))
                    
                    //Total Komponen 150
                    .concat(['B3RAD0000255'].map(key => [key, 150]))

                    //Total Komponen 100
                    .concat([
                    'B0AARR000024', 'B1BCCG000002', 'B3PAA0000469', 'B3PAA0000555', 'B3PAA0000556',
                    'B3PAA0000585', 'B3PAA0000586', 'B3PAA0000630', 'B3PAA0000724', 'B3RAD0000226',
                    'C2DBYY001899'
                    ].map(key => [key, 100]))

                    //Total Komponen 50
                    .concat([
                    'B0EBKR000038', 'B1ACPG000007', 'B2BAGS000002', 'B2BAHT000001', 'C1BA00000082',
                    'C1BA00000418','C1BA00000507'
                    ].map(key => [key, 50]))

                    //Total Komponen 45
                    .concat([
                    'B3PAC0000185', 'C0DAAYY00092', 'C0DAAYY00124', 'C0DACYY00017', 'C0DACYY00018'
                    ].map(key => [key, 45]))

                    //Total Komponen 25
                    .concat([
                    'C0AAAA000036', 'C1AA00000829', 'C1AA00000837', 'C1AA00000847', 'C1AB00004522',
                    'C1BA00000414', 'C1BA00000421', 'C1BA00000424', 'C1BA00000481', 'C1BA00000482',
                    'C1BA00000504', 'C1BA00000505'
                    ].map(key => [key, 25]))

                    //Total Komponen 22
                    .concat(['C1BA00000422'].map(key => [key, 22]))

                    //Total Komponen 20
                    .concat(['C0ZAZ0000155','C0ZAZ0000156','C1BA00000399','C1BA00000406','C1BA00000420'].map(key => [key, 25]))                    

                    //Total Komponen 15
                    .concat(['B1KAC0000281'].map(key => [key, 15]))

                    //Total Komponen 1
                    .concat([
                    'C0EBA0000047', 'C0EBL0000070', 'C0JBAR000573', 'C0JBAS000160', 'C0ZBZ0001747',
                    'C1AB00003912', 'C1BA00000415', 'C1BA00000423', 'C2CBYY001054', 'C2CBYY001662',
                    'C2CBYY002092', 'C2DBYY001358', 'C2RXFS22APK', 'C2RXFS22AFN', 'C3FBMY000303',
                    'C3FBYY000035','C3FBYY000055'
                    ].map(key => [key, 1]))
                );

                const predefinedValue = predefinedValues[selectedItem];
                if (predefinedValue !== undefined) {
                    hasilInput.value = predefinedValue;
                } else {
                    hasilInput.value = "Mohon Maaf Nilai Belum diinput, Tolong Inputkan Manual";
                }
            } else {
                jarakInput.disabled = false;
                hitungHasil();
            }
        }
        
        function hitungHasil() {
        const bypassCheckbox = document.getElementById('bypassCalculation');
        if (bypassCheckbox.checked) {
            return; // Jika checkbox dicentang, hentikan perhitungan
        }

        const input = parseFloat(document.getElementById('jarak_main').value);
        const location = document.getElementById('location_main').value;

        if (selectedManualInput) {
            // Jika input manual dipilih, hasil perhitungan sama dengan input jarak
            document.getElementById('hasilPerhitungan_main').value = input.toString();
        } else if (input && input > 0) {
                let dIn = 0;
                let p = 0;
                let t = 0;
                // Data untuk listBox2
                const listBox2Items = {
                    'B0ACCK000005': {'dIn': 71.29, 't': 1.18, 'p': 4},  
                    'B0ACCK000012': {'dIn': 62.09, 't': 1.2, 'p': 4}, // Tes  
                    'B0ACCL000017': {'dIn': 56.91, 't': 1.47, 'p': 4}, // g  
                    'B0ACDR000001': {'dIn': 62.21, 't': 1.1, 'p': 4},  
                    'B0BC7R4A0259': {'dIn': 62.98, 't': 1.3, 'p': 4},  
                    'B0BC8R1A0259': {'dIn': 62.5, 't': 1.28, 'p': 4}, // g  
                    'B1ABMG000014': {'dIn': 50, 't': 2, 'p': 3.5},  
                    'B0ADDH000004': {'dIn': 52, 't': 1.8, 'p': 3.5},  
                    'B0ADDH000009': {'dIn': 56.94, 't': 1.467, 'p': 4}, // g  
                    'B0BC019A0007': {'dIn': 62.08, 't': 1.13, 'p': 4}, // g  
                    'B0BC025A0245': {'dIn': 62.76, 't': 1.2, 'p': 4}, // g  
                    'B0BC02900004': {'dIn': 47, 't': 2.6, 'p': 8},  
                    'B0BC4R0A0006': {'dIn': 62.18, 't': 1.15, 'p': 4}, // g  
                    'B0BC8R2A0908': {'dIn': 60.56, 't': 1.18, 'p': 4},  //g
                    'B0ECKM000072': {'dIn': 57.1, 't': 1.57, 'p': 4}, //G  
                    'B0ECKP000099': {'dIn': 64.7, 't': 2.58, 'p': 4},  
                    'B0ECKR000089': {'dIn': 65.03, 't': 2.53, 'p': 4},  //G
                    'B0ECKT000009': {'dIn': 61, 't': 2.4, 'p': 3.5},  
                    'B0ECKT000012': {'dIn': 64.89, 't': 2.34, 'p': 4},  
                    'B0ECMR000030': {'dIn': 64, 't': 2.9, 'p': 3.5},  
                    'B0ECKV000038': {'dIn': 64.5, 't': 2.55, 'p': 4}, // g  
                    'B0EDKR000014': {'dIn': 66, 't': 3.1, 'p': 3.5},  
                    'B0EDLU000001': {'dIn': 67, 't': 3.2, 'p': 3.5},  
                    'B0JCCD000020': {'dIn': 68, 't': 3.3, 'p': 3.5},  
                    'B0JCCD000041': {'dIn': 62.81, 't': 1.18, 'p': 4},  
                    'B0JCCE000003': {'dIn': 64.01, 't': 1.22, 'p': 4}, // g  
                    'B0JCDD000046': {'dIn': 62.1, 't': 0.82, 'p': 2}, // g  
                    'B0JCGE000020': {'dIn': 57.1, 't': 1.422, 'p': 4}, // g  
                    'B0JCMA000003': {'dIn': 62.24, 't': 1.21, 'p': 4}, // g  
                    'B0JCMC000006': {'dIn': 62.84, 't': 1.27, 'p': 4}, // g  
                    'B0ECMM000009': {'dIn': 65.06, 't': 2.55, 'p': 4}, // g  
                    'B0JCNC000008': {'dIn': 62.36, 't': 1.19, 'p': 4}, // g  
                    'B0JCNE000039': {'dIn': 62.82, 't': 1.335, 'p': 4}, // g  
                    'B0JCPL000020': {'dIn': 62.89, 't': 1.4, 'p': 4}, //G  
                    'B0ZBZ0000230': {'dIn': 62.2, 't': 0.805, 'p': 2}, // g  
                    'B1ABAB000064': {'dIn': 63.74, 't': 1.47, 'p': 4}, // g  
                    'B1ABCF000010': {'dIn': 62.99, 't': 1.45, 'p': 4},  
                    'B1ABCF000020': {'dIn': 62.69, 't': 1.28, 'p': 4}, // g  
                    'B1ABCF000103': {'dIn': 62.32, 't': 1.02, 'p': 4}, // g  
                    'B1ABCF000176': {'dIn': 63.46, 't': 1.45, 'p': 4}, //G  
                    'B1ADCE000012': {'dIn': 63.15, 't': 1.4, 'p': 4}, // g  
                    'B1ADCF000020': {'dIn': 62.4, 't': 1.05, 'p': 4}, // g  
                    'B1ADCF000063': {'dIn': 62.74, 't': 1.26, 'p': 4}, // g  
                    'B1ADGD000004': {'dIn': 62.7, 't': 1.25, 'p': 4}, // g  
                    'B1ADKD000009': {'dIn': 63.07, 't': 1.4, 'p': 4}, //G  
                    'B1ADMF000016': {'dIn': 63.8, 't': 1.85, 'p': 8}, // g  
                    'B1ADND000007': {'dIn': 64.36, 't': 2.11, 'p': 8}, //G 
                    'B1CFHC000003': {'dIn': 62.74, 't': 1.25, 'p': 4}, // g  
                    'B1CFQD000023': {'dIn': 93, 't': 5.8, 'p': 3.5},  
                    'B1CHQD000014': {'dIn': 62.6, 't': 1.15, 'p': 4}, // g  
                    'B1CHPB000012': {'dIn': 95, 't': 6, 'p': 3.5},  
                    'B1GBCFEE0004': {'dIn': 62.86, 't': 1.26, 'p': 4}, // g  
                    'B1GBCFGG0011': {'dIn': 62.68, 't': 1.24, 'p': 4}, // g  
                    'B1GBCFGG0024': {'dIn': 63.18, 't': 1.32, 'p': 4}, // g  
                    'B1GBCFGH0001': {'dIn': 62.9, 't': 1.48, 'p': 4},  
                    'B1GBCFGJ0013': {'dIn': 63.72, 't': 1.62, 'p': 4}, //G
                    'B1GBCFJJ0040': {'dIn': 63.57, 't': 1.35, 'p': 4}, //G
                    
                    'B1GBCFGN0019': {'dIn': 63.9, 't': 1.5, 'p': 4}, //BELOM
                    'B1GDCFGG0033': {'dIn': 63.9, 't': 1.5, 'p': 4},//G
                    'CODBAYY02861': {'dIn': 60.07, 't': 1.6, 'p': 4},//G
                    'F3F0J1570001': {'dIn': 64.12, 't': 2.2, 'p': 4},//G
                    'B1GDCFJ10047': {'dIn': 63.45, 't': 1.5, 'p': 4},//G
                    'B1GDCFGJ0010': {'dIn': 63.89, 't': 1.5, 'p': 4},//G
                    'F3F0J4760004': {'dIn': 64.25, 't': 2.28, 'p': 4},//G
                    'F1J1E334A161': {'dIn': 63.13, 't': 1.5, 'p': 4},//G
                    'F1J1A106A146': {'dIn': 61.42, 't': 1.45, 'p': 4},//G
                    'F1J0J106A102': {'dIn': 61.4, 't': 1.5, 'p': 4},//G
                    'C0DBZMC00006': {'dIn': 62.6, 't': 1.35, 'p': 4},//G
                    'F1K1E106A121': {'dIn': 63.88, 't': 1.99, 'p': 4},//G
                    'F1K1E106A167': {'dIn': 62.29, 't': 1.85, 'p': 4},//G
                    'F1J0J226A091': {'dIn': 62.94, 't': 1.59, 'p': 4},//G
                    'F1J1C106A224': {'dIn': 61.47, 't': 1.55, 'p': 4},//G
                    'F1J1E106A315': {'dIn': 62.86, 't': 1.55, 'p': 4},//G
                    'F3F0J107A064': {'dIn': 62.42, 't': 1.45, 'p': 4},//G
                    'F3F0G2270002': {'dIn': 62.58, 't': 1.45, 'p': 4},//G
                    'J0ZZB0000238': {'dIn': 56.74, 't': 1.3, 'p': 4},//G
                    'B1GBCFJJ0002': {'dIn': 62.92, 't': 1.5, 'p': 4},//G
                    'H0J120500096': {'dIn': 63.29, 't': 1.53, 'p': 4}, //G
                    'H0J384500009': {'dIn': 61.55, 't': 1.25, 'p': 4}, //G
                    'RLQM1R0MT-M' : {'dIn': 62.6, 't': 1.3, 'p': 4}, //g
                    'RLQM2R2MT-M' : {'dIn': 62.58, 't': 1.29, 'p': 4}, //g
                    'D4FB1R100015': {'dIn': 62.5, 't': 1.1, 'p': 4}, //g
                    'C0DBGYY000919': {'dIn': 62.63, 't': 1.32, 'p': 4}, //g
                    'B3AAB0000322': {'dIn': 62.54, 't': 1.35, 'p': 4}, //g
                    'B1GKCFJN0004': {'dIn': 62.98, 't': 1.32, 'p': 4}, //g
                    'B1GDCFNA0011': {'dIn': 61.48, 't': 0.87, 'p': 2}, //g
                    'B1GBCFNA0016': {'dIn': 61.72, 't': 1.05, 'p': 2}, //g
                    'B1GBCFJN0009': {'dIn': 62.28, 't': 1.3, 'p': 4}, //g
                    'C0JBAR000699': {'dIn': 63.38, 't': 1.55, 'p': 4}, //g
                    'B1GBCFGJ0020': {'dIn': 63.4, 't': 1.33, 'p': 4}, //g
                    'B1GBCFGN0022': {'dIn': 63.52, 't': 1.4, 'p': 4}, //G
                    'B1GDCFGG0005': {'dIn': 62.88, 't': 1.3, 'p': 4}, //G
                    'B1GDCFGG0028': {'dIn': 63.47, 't': 1.3, 'p': 4}, //G
                    'C0DBAYY01511': {'dIn': 63.89, 't': 1.7, 'p': 4}, //G
                    'C0DBGYY02678': {'dIn': 64.57, 't': 2.3, 'p': 8}, //G
                    'C0DBGYY02049': {'dIn': 63.32, 't': 1.8, 'p': 4}, //G
                    'C0DBGYY07480': {'dIn': 64.15, 't': 2, 'p': 8}, //G

                    'C0EBY0000631' : {'dIn': 63.9, 't': 1.5, 'p': 4}, //BELOM
                    'C0EBY0001278' : {'dIn': 62.8, 't': 1.48, 'p': 4}, //G
                    'C0EBY0002216' : {'dIn': 62.16, 't': 0.78, 'p': 2}, //G
                    'C0EBY0002221' : {'dIn': 62.22, 't': 1.34, 'p': 4},//G
                    'C0EBY0002224' : {'dIn': 62.52, 't': 1.45, 'p': 4}, //G
                    'C0EBY0002225' : {'dIn': 62.51, 't': 1.4, 'p': 4}, //G
                    'C0EBY0002226' : {'dIn': 62.26, 't': 1.35, 'p': 4}, //G
                    'H0J327200085' : {'dIn': 64.28, 't': 1.95, 'p': 4}, //G
                    'F1J2E103A035' : {'dIn': 63.26, 't': 1.55, 'p': 4}, //G
                    'F1J1E105A171' : {'dIn': 62.14, 't': 1.58, 'p': 4}, //G
                };

                // Data untuk listBox1
                const validItemsD0GA = [
                'D0GA100JA023', 'D0GA101JA023', 'D0GA102JA023', 'D0GA103JA023', 'D0GA104JA023', 'D0GA105JA023', 
                'D0GA122JA023', 'D0GA123JA023', 'D0GA180JA023', 'D0GA183JA023', 'D0GA201JA023', 'D0GA203JA023', 
                'D0GA220JA023', 'D0GA221JA023', 'D0GA222JA023', 'D0GA224JA023', 'D0GA243JA023', 'D0GA271JA023', 
                'D0GA273JA023', 'D0GA330JA023', 'D0GA331JA023', 'D0GA333JA023', 'D0GA472JA023', 'D0GA473JA023', 
                'D0GA512JA023', 'D0GA560JA023', 'D0GA563JA023', 'D0GA681JA023', 'D0GA682JA023', 'D0GA822JA023', 
                'D0GAR00J0005'];

                const validItemsD0GB = [
                'D0GB100JA065', 'D0GB101JA065', 'D0GB102JA065', 'D0GB102ZA028', 'D0GB103JA065', 'D0GB104JA065', 
                'D0GB105JA065', 'D0GB112JA065', 'D0GB122JA065', 'D0GB123JA065', 'D0GB124JA065', 'D0GB132JA065', 
                'D0GB133JA065', 'D0GB150JA065', 'D0GB151JA065', 'D0GB152JA065', 'D0GB153JA065', 'D0GB154JA065', 
                'D0GB162JA065', 'D0GB182JA065', 'D0GB183JA065', 'D0GB184JA065', 'D0GB202JA007', 'D0GB202JA065', 
                'D0GB333JA065', 'D0GB334JA065', 'D0GB3R3JA065', 'D0GB431JA065', 'D0GB470JA065', 'D0GB471JA065', 
                'D0GB472JA065', 'D0GB472ZA028', 'D0GB473JA065', 'D0GB474JA065', 'D0GB475JA065', 'D0GB4R7JA065', 
                'D0GB510JA065', 'D0GB511JA065', 'D0GB512JA065', 'D0GB561JA065', 'D0GB562JA065', 'D0GB563JA065', 
                'D0GB680JA065', 'D0GB681JA065', 'D0GB682JA065', 'D0GB683JA065', 'D0GB684JA065', 'D0GB752JA065', 
                'D0GB820JA065', 'D0GB821JA065', 'D0GB822JA065', 'D0GB912ZA029', 'D0GBR00J0004', 'ERJ3GEYJ132V', 
                'ERBRE0R50V','D0GB332JA065','D0GB271JA065' , 'D0GB272JA065' , 'D0GB273JA065' ,'D0GB2R2JA065' ,
                'D0GB303ZA028', 'D0GB221JA065', 'D0GB222JA065', 'D0GB223JA065', 'D0GB224JA065', 'D0GB243JA065',
                'D0GB331JA065', 'D0GB274JA065', 'D0GB220JA065', 'D0GB203JA065'
                ];

                const validItemsD0GD = [
                'D0GD101JA052', 'D0GD102JA052', 'D0GD103JA052', 'D0GD104JA052','D0GD122JA052', 'D0GD202JA052', 
                'D0GD271JA052', 'D0GD470JA052','D0GD471JA052', 'D0GD681JA052', 'D0GD752JA052', 'D0GDR00J0004'
                ];

                const validItemsD0GF = [
                'D0GF101JA048', 'D0GF102JA048', 'D0GF102ZA002', 'D0GF104JA048', 'D0GF122JA048',
                'D0GF150JA048', 'D0GF181JA048', 'D0GF220JA048', 'D0GF1R2JA048', 'D0GF6R8JA048',
                'D0GF222JA048', 'D0GF242ZA002', 'D0GF243JA048', 'D0GF271JA048', 'D0GF301JA038',
                'D0GF333JA048', 'D0GF334JA048', 'D0GF360JA048', 'D0GF364JA048', 'D0GF622JA048',
                'D0GF681JA048', 'D0GF751JA048', 'D0GFR00J0005'
                ];

                const validItemsD0GL = ['D0GL104J0001'];

                const validItemsD0GZ = ['D0GZ104JA022', 'D0GZ430JA022', 'D0GZ751JA022', 'ERJ12YJ104U'];

                const validItemsD1BA = [
                'D1BA1002A023', 'D1BA1003A023', 'D1BA1502A023', 'D1BA1302A023', 'D1BA1800A023',
                'D1BA1802A022', 'D1BA2002A023', 'D1BA2701A023', 'D1BA3001A023', 'D1BA3002A023',
                'D1BA3301A022', 'D1BA3301A023', 'D1BA3903A022', 'D1BA4302A023', 'D1BA4702A022',
                'D1BA5101A022', 'D1BA6803A022', 'D1BA8661A023', 'D1BA9101A023', 'D1BB6202A073'
                ];

                const validItemsD1BB = [
                'D1BB1002A073', 'D1BB1002A074', 'D1BB1003A073', 'D1BB1003A074', 'D1BB1004A073',
                'D1BB1202A073', 'D1BB1211A073', 'D1BB1211A141', 'D1BB1302A073', 'D1BB1501A073',
                'D1BB1502A073', 'D1BB1503A074', 'D1BB1600A073', 'D1BB1802A073', 'D1BB2002A073',
                'D1BB2002A074', 'D1BB2201A073', 'D1BB2203A074', 'D1BB2402A073', 'D1BB2433A074',
                'D1BB2700A073', 'D1BB2702A074', 'D1BB3001A073', 'D1BB3002A073', 'D1BB3002A074',
                'D1BB3301A073', 'D1BB3301A074', 'D1BB3601A073', 'D1BB3902A073', 'D1BB3921A073',
                'D1BB4222A073', 'D1BB4301A074', 'D1BB4302A074', 'D1BB4702A073', 'D1BB4702A074',
                'D1BB4751A073', 'D1BB5101A074', 'D1BB5102A073', 'D1BB5492A073', 'D1BB5621A073',
                'D1BB6801A073', 'D1BB6802A073', 'D1BB8201A073', 'D1BB8202A073', 'D1BB82R0A073',
                'D1BB8661A073', 'D1BB9101A073', 'D1BB9311A073'
                ];

                const validItemsD1BF = [
                'D1BF4023A073', 'D1BF1100A073', 'D1BFR390A047', 'D1BFR430A047', 'D1BF1000A067', 
                'D1BF1000A073', 'D1BF1100A067', 'D1BF2003A064', 'D1BF2003A098', 'D1BF4023A067',
                'D1BFR510A065',];
            
                const validItemsD1BR = ['D1BRR120A064'];

                // const validItemsD4FB = ['D4FB1R100015'];

                const validItemsG1C4 = ['G1C4R7MA1323'];

                const validItemsK5H5 = ['K5H501Y00012'];

                const validItemsG1CR = ['G1CR15K00017'];

                const validItemsG1CR2 = ['G1CR22GA0007'];

                const validItemsG1C6 = ['G1C68NJA0037'];

                const validItemsG1CR1 = ['G1CR12GA0007'];

                const validItemsJ0JY = ['J0JYC0000426'];

                const validItemsJ0JYC = ['J0JYC0000051'];

                const validItemsJ0JYC0 = ['J0JYC0000251'];

                const validItemsG1C4R7 = ['G1C4R7K00013'];

                const validItemsD4CC = ['D4CC11030018', 'D4CC1103A038'];

                const validItemsF1G1A = ['F1G1A104A026', 'F1G1A1050004', 'F1G1A475A099'];

                const validItemsF1G1H = [
                'F1G1H101A807', 'F1G1H102A830', 'F1G1H102A548', 'F1G1H103A548', 'F1G1H103B104',
                'F1G1H121B065', 'F1G1H152A548', 'F1G1H221A548', 'F1G1H223A548', 'F1G1H272A548',
                'F1G1H330A807', 'F1G1H332A548', 'F1G1H471A548', 'F1G1H5R0B062', 'F1G1H821B065',
                'F1G1H2R2A982', 'F1G1E104A078', 'F1G1E105A186', 'F1G1E224A193', 'F1G1E225A183', 
                'F1G1H471A807'
                ];

                const validItemsF1H0 = ['F1H0J1060003'];
            
                const validItemsF1H1A = [
                'F1H1A1050040', 'F1H1A154A046', 'F1H1A334A159', 'F1H1A474A046', 'F1H1A475A102'
                ];

                const validItemsF1H1E = [
                'F1H1E104A086', 'F1H1E1050009', 'F1H1E224A086', 'F1H1E224A161', 'F1H1E273A002',
                'F1H1E473A086', 'F1H1E475A205', 'F1H1E683A086'
                ];

                const validItemsF1H1H = [
                'F1H1C103A107', 'F1H1C104A107', 'F1H1C105A107', 'F1H1C105A167', 'F1H1C225A215',
                'F1H1C334A107', 'F1H1C823A107', 'F1H1H100B043', 'F1H1H1010014', 'F1H1H102A842',
                'F1H1H102B047', 'F1H1H103B047', 'F1H1H103A842', 'F1H1H104B047', 'F1H1H120A860',
                'F1H1H122A013', 'F1H1H150A004', 'F1H1H151B043', 'F1H1H152A842', 'F1H1H153A842',
                'F1H1H180B043', 'F1H1H1R0A016', 'F1H1H200A831', 'F1H1H220B043', 'F1H1H221A004',
                'F1H1H222A842', 'F1H1H223B047', 'F1H1H270A004', 'F1H1H272A842', 'F1H1H330B043',
                'F1H1H331B043', 'F1H1H332A842', 'F1H1H333A842', 'F1H1H3R0B170', 'F1H1H471B043',
                'F1H1H472A842', 'F1H1H4R0B170', 'F1H1H561A219', 'F1H1H5R0B170', 'F1H1H682A842',
                'F1H1H6R0A016', 'F1H1H7R0B091', 'F1H1H822A842', 'F1H1H8R0B091'
                ];

                const validItemsF1G0 = ['F1G0J105A063'];

                const validItemsF1J2 = ['F1J2E102A036'];

                // Cek apakah item dari listBox2 dipilih
                if (listBox2Items[selectedListBox2Item]) {
                    dIn = listBox2Items[selectedListBox2Item].dIn;
                    t = listBox2Items[selectedListBox2Item].t;
                    p = listBox2Items[selectedListBox2Item].p;
                } 
                // Jika tidak, cek item dari listBox1
                else if (selectedListBox1Item) {
                    if (validItemsD0GA.includes(selectedListBox1Item)) {
                        dIn = 62; // Nilai dIn untuk semua item ini 
                        p = 2; // Nilai p untuk semua item ini 
                        t = 0.56; // Nilai t untuk semua item ini
                    } else if (validItemsD0GB.includes(selectedListBox1Item)) {
                        dIn = 62; // Nilai dIn untuk semua item ini
                        p = 4; // Nilai p untuk semua item ini 
                        t = 0.7; // Nilai t untuk semua item ini 
                    } else if (validItemsD0GD.includes(selectedListBox1Item)) {
                        dIn = 61.6; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 0.86; // Nilai t untuk semua item ini 
                    } else if (validItemsD0GF.includes(selectedListBox1Item)) {
                        dIn = 61.59; // Nilai dIn untuk semua item ini
                        p = 4; // Nilai p untuk semua item ini 
                        t = 0.825; // Nilai t untuk semua item ini 
                    } else if (validItemsD0GL.includes(selectedListBox1Item)) {
                        dIn = 62.94; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 0.97; // Nilai t untuk semua item ini 
                    } else if (validItemsD0GZ.includes(selectedListBox1Item)) {
                        dIn = 61.8; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 0.8; // Nilai t untuk semua item ini 
                    } else if (validItemsD1BA.includes(selectedListBox1Item)) {
                        dIn = 60.92; // Nilai dIn untuk semua item ini 
                        p = 2; // Nilai p untuk semua item ini 
                        t = 0.53; // Nilai t untuk semua item ini 
                    } else if (validItemsD1BB.includes(selectedListBox1Item)) {
                        dIn = 61.2; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 0.7; // Nilai t untuk semua item ini 
                    } else if (validItemsD1BR.includes(selectedListBox1Item)) {
                        dIn = 60; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 1; // Nilai t untuk semua item ini 
                    } 
                    // else if (validItemsD4FB.includes(selectedListBox1Item)) {
                    //     dIn = 62.5; // Nilai dIn untuk semua item ini 
                    //     p = 4; // Nilai p untuk semua item ini 
                    //     t = 1.1; // Nilai t untuk semua item ini 
                    // } 
                    else if (validItemsD4CC.includes(selectedListBox1Item)) {
                        dIn = 60; // Nilai dIn untuk semua item ini
                        p = 4; // Nilai p untuk semua item ini 
                        t = 1.05; // Nilai t untuk semua item ini 
                    }  else if (validItemsF1G1A.includes(selectedListBox1Item)) {
                        dIn = 61.6; // Nilai dIn untuk semua item ini 
                        p = 2; // Nilai p untuk semua item ini 
                        t = 0.7; // Nilai t untuk semua item ini 
                    } else if (validItemsF1G1H.includes(selectedListBox1Item)) {
                        dIn = 61.5; // Nilai dIn untuk semua item ini 
                        p = 2; // Nilai p untuk semua item ini 
                        t = 0.75; // Nilai t untuk semua item ini 
                    } else if (validItemsF1H1A.includes(selectedListBox1Item)) {
                        dIn = 63.7; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini
                        t = 1.1; // Nilai t untuk semua item ini 
                    } else if (validItemsF1H1E.includes(selectedListBox1Item)) {
                        dIn = 61.8; // Nilai dIn untuk semua item ini
                        p = 4; // Nilai p untuk semua item ini 
                        t = 1.1; // Nilai t untuk semua item ini 
                    } else if (validItemsF1H1H.includes(selectedListBox1Item)) {
                        dIn = 62.8; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 1; // Nilai t untuk semua item ini 
                    } else if (validItemsG1C4.includes(selectedListBox1Item)) {
                        dIn = 62.12; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 1.09; // Nilai t untuk semua item ini 
                    } else if (validItemsK5H5.includes(selectedListBox1Item)) {
                        dIn = 61.72; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 0.88; // Nilai t untuk semua item ini 
                    } else if (validItemsG1CR.includes(selectedListBox1Item)) {
                        dIn = 62.28; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 1.09; // Nilai t untuk semua item ini 
                    } else if (validItemsG1CR2.includes(selectedListBox1Item)) {
                        dIn = 64.62; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 1.065; // Nilai t untuk semua item ini 
                    } else if (validItemsG1C6.includes(selectedListBox1Item)) {
                        dIn = 63.09; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 1.04; // Nilai t untuk semua item ini 
                    } else if (validItemsG1CR1.includes(selectedListBox1Item)) {
                        dIn = 61.24; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 1.01; // Nilai t untuk semua item ini 
                    } else if (validItemsJ0JY.includes(selectedListBox1Item)) {
                        dIn = 61.22; // Nilai dIn untuk semua item ini 
                        p = 2; // Nilai p untuk semua item ini 
                        t = 0.74; // Nilai t untuk semua item ini 
                    } else if (validItemsJ0JYC.includes(selectedListBox1Item)) {
                        dIn = 61.606; // Nilai dIn untuk semua item ini 
                        p = 2; // Nilai p untuk semua item ini 
                        t = 0.678; // Nilai t untuk semua item ini 
                    } else if (validItemsJ0JYC0.includes(selectedListBox1Item)) {
                        dIn = 62.17; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 1.1; // Nilai t untuk semua item ini 
                    } else if (validItemsG1C4R7.includes(selectedListBox1Item)) {
                        dIn = 64.42; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 1.1; // Nilai t untuk semua item ini 
                    } else if (validItemsD1BF.includes(selectedListBox1Item)) {
                        dIn = 61.59; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 0.89; // Nilai t untuk semua item ini 
                    } else if (validItemsF1H0.includes(selectedListBox1Item)) {
                        dIn = 63.63; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 1.12; // Nilai t untuk semua item ini 
                    } else if (validItemsF1G0.includes(selectedListBox1Item)) {
                        dIn = 60.31; // Nilai dIn untuk semua item ini 
                        p = 2; // Nilai p untuk semua item ini 
                        t = 0.74; // Nilai t untuk semua item ini 
                    } else if (validItemsF1J2.includes(selectedListBox1Item)) {
                        dIn = 62.73; // Nilai dIn untuk semua item ini 
                        p = 4; // Nilai p untuk semua item ini 
                        t = 1.33; // Nilai t untuk semua item ini 
                    }
                }

                // Hitung numerator dan denominator
                const numerator = (input * 2 + dIn) * (input * 2 + dIn) - (dIn * dIn);
                const denominator = 4 * p * t;

                // Validasi hasil perhitungan
                if (isNaN(numerator) || isNaN(denominator) || denominator === 0) {
                    document.getElementById('hasilPerhitungan_main').value = "Perhitungan tidak valid";
                } else {
                    const location = document.getElementById('location_main').value;
                    let result = 0;
                    if (location === 'RACK') {
                        result = (3.14 * numerator) / denominator;
                    } else if (location === 'SMT 1') {
                        if (p === 2) {
                            result = ((3.14 * numerator) / denominator) + 240;
                        } else if (p === 4) {
                            result = ((3.14 * numerator) / denominator) + 120;
                        } else if (p === 8) {
                            result = ((3.14 * numerator) / denominator) + 60;
                        }
                    } else if (location === 'SMT 2' || location === 'SMT 3') {
                        if (p === 2) {
                            result = ((3.14 * numerator) / denominator) + 460;
                        } else if (p === 4) {
                            result = ((3.14 * numerator) / denominator) + 230;
                        } else if (p === 8) {
                            result = ((3.14 * numerator) / denominator) + 115;
                        }
                    }
                    document.getElementById('hasilPerhitungan_main').value = Math.floor(result).toString();
                }
            } else {
                document.getElementById('hasilPerhitungan_main').value = "Masukkan dengan Benar";
            }
        }

        function tambahKeTabel() {
        const komponen = selectedListBox1Item || selectedListBox2Item || selectedManualInput;
        const hasil = parseInt(document.getElementById('hasilPerhitungan_main').value);
        const tanggal = new Date().toISOString().split('T')[0];
        const mesin = document.getElementById('location_main').value;
        const operator = document.getElementById('operator_main').value;

        // Validasi
        if (!operator.trim()) {
            alert('Nama Operator tidak boleh kosong.');
            return;
        }

        if (!komponen) {
            alert('Komponen tidak boleh kosong.');
            return;
        }

        if (isNaN(hasil) || hasil <= 0) {
            alert('Hasil perhitungan tidak valid.');
            return;
        }

        // Simpan data ke tableData
        if (!tableData[komponen]) {
            tableData[komponen] = [];
        }
        tableData[komponen].push({
            Mesin: mesin,
            Operator: operator,
            Komponen: komponen,
            Hasil: hasil,
            Tanggal: tanggal,
        });

        // Update komponenTotal
        if (komponenTotal[komponen]) {
            komponenTotal[komponen] += hasil;
        } else {
            komponenTotal[komponen] = hasil;
        }

        // Simpan data ke historyData
        if (!historyData[mesin][komponen]) {
            historyData[mesin][komponen] = [];
        }
        historyData[mesin][komponen].push({
            Hasil: hasil,
            Tanggal: tanggal,
            Operator: operator,
        });

        // Simpan data ke localStorage
        saveData();

        // Render ulang tabel dan update total
        renderTable();
        updateTotal();
        renderTableRiwayat();

        // Reset checkbox bypass
        document.getElementById('bypassCalculation').checked = false;
        toggleBypassCalculation();
    }


        function hapusData(komponen, index) {
            const mesin = document.getElementById('location_main').value;
            const hasil = tableData[komponen][index].Hasil;

            komponenTotal[komponen] -= hasil;
            tableData[komponen].splice(index, 1);

            if (tableData[komponen].length === 0) {
                delete tableData[komponen];
            }

            if (historyData[mesin][komponen]) {
                historyData[mesin][komponen].splice(index, 1);
                if (historyData[mesin][komponen].length === 0) {
                    delete historyData[mesin][komponen];
                }
            }

            saveData();
            renderTable();
            updateTotal();
            renderTableRiwayat();
        }

        function showDeleteConfirmationRiwayat(mesin, komponen, index) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini dari riwayat?')) {
                hapusDataRiwayat(mesin, komponen, index);
            }
        }

        function hapusDataRiwayat(mesin, komponen, index) {
            // Hapus dari historyData
            historyData[mesin][komponen].splice(index, 1);
            if (historyData[mesin][komponen].length === 0) {
                delete historyData[mesin][komponen];
            }

            // Simpan data
            saveData();
            renderTableRiwayat(); // Refresh tabel riwayat
        }

        function renderTable() {
            const tbody = document.getElementById('tabelInput').getElementsByTagName('tbody')[0];
            tbody.innerHTML = ''; // Kosongkan tabel sebelum merender ulang

            const komponen = selectedListBox1Item || selectedListBox2Item || selectedManualInput;
            if (tableData[komponen]) {
                tableData[komponen].forEach((row, index) => {
                    const rowElement = document.createElement('tr');
                    rowElement.innerHTML = `
                        <td>${row.Komponen}</td>
                        <td>${row.Operator}</td>
                        <td>${row.Mesin}</td>
                        <td>${row.Hasil}</td>
                    `;
                    tbody.appendChild(rowElement);
                });
            }

            updateTotal(); // Update total setelah merender tabel
        }

        function updateTotal() {
            const komponen = selectedListBox1Item || selectedListBox2Item;
            document.getElementById('total_main').value = komponenTotal[komponen] || 0;
        }

        function saveData() {
            localStorage.setItem('tableData', JSON.stringify(tableData));
            localStorage.setItem('komponenTotal', JSON.stringify(komponenTotal));
            localStorage.setItem('historyData', JSON.stringify(historyData));
        }

        function showRiwayat() {
            const riwayatSection = document.getElementById('riwayatSection');
            if (riwayatSection.style.display === 'none') {
                riwayatSection.style.display = 'block';
                renderTableRiwayat();
            } else {
                riwayatSection.style.display = 'none';
            }
        }

        function renderTableRiwayat(location = 'all') {
        const tbody = document.getElementById('tabelRiwayat').getElementsByTagName('tbody')[0];
        tbody.innerHTML = ''; // Kosongkan tabel sebelum merender ulang
    
        for (const mesin in historyData) {
            if (location === 'all' || mesin === location) {
                for (const komponen in historyData[mesin]) {
                    historyData[mesin][komponen].forEach((data, index) => {
                        const rowElement = document.createElement('tr');
                        rowElement.innerHTML = `
                            <td>${data.Tanggal}</td>
                            <td>${komponen}</td>
                            <td>${data.Operator}</td>
                            <td>${mesin}</td>
                            <td>${data.Hasil}</td>
                            <td><button onclick="showDeleteConfirmationRiwayat('${mesin}', '${komponen}', ${index})">Hapus</button></td>
                        `;
                        tbody.appendChild(rowElement);
                    });
                }
            }
        }
    }

        function filterData() {
            const location = document.getElementById('location_riwayat').value;
            renderTableRiwayat(location);
        }

        function exportToExcel() {
            const location = document.getElementById('location_riwayat').value;
            const wb = XLSX.utils.book_new();
            const wsData = [];

            // Header untuk Excel
            const header = ["Tanggal", "Nama Komponen", "Operator", "Mesin", "Hasil"];
            wsData.push(header);

            // Mengisi data berdasarkan lokasi (SMT 1-4 atau semua)
            for (const mesin in historyData) {
                if (location === 'all' || mesin === location) {
                    for (const komponen in historyData[mesin]) {
                        historyData[mesin][komponen].forEach(data => {
                            const row = [
                                data.Tanggal,
                                komponen,
                                data.Operator, // Use the stored operator
                                mesin,
                                data.Hasil
                            ];
                            wsData.push(row);
                        });
                    }
                }
            }

            // Membuat worksheet dari data
            const ws = XLSX.utils.aoa_to_sheet(wsData);

            // Mengatur style untuk header (bold dan alignment)
            const headerStyle = {
                font: { bold: true },
                alignment: { horizontal: 'center' }
            };
            for (let col = 0; col < header.length; col++) {
                const cellAddress = XLSX.utils.encode_cell({ r: 0, c: col });
                if (!ws[cellAddress].s) ws[cellAddress].s = {};
                Object.assign(ws[cellAddress].s, headerStyle);
            }

            // Menambahkan border ke semua sel
            const range = XLSX.utils.decode_range(ws['!ref']);
            for (let row = range.s.r; row <= range.e.r; row++) {
                for (let col = range.s.c; col <= range.e.c; col++) {
                    const cellAddress = XLSX.utils.encode_cell({ r: row, c: col });
                    if (!ws[cellAddress].s) ws[cellAddress].s = {};
                    ws[cellAddress].s.border = {
                        top: { style: 'thin' },
                        bottom: { style: 'thin' },
                        left: { style: 'thin' },
                        right: { style: 'thin' }
                    };
                }
            }

            // Menambahkan worksheet ke workbook
            XLSX.utils.book_append_sheet(wb, ws, "Data Komponen");

            // Menyimpan file Excel
            const fileName = location === 'all' ? 'Riwayat_Semua_SMT.xlsx' : `Riwayat_SMT_${location.split(' ')[1]}.xlsx`;
            XLSX.writeFile(wb, fileName);
        }
        function exportTotal() {
        const location = document.getElementById('location_riwayat').value;
        const wb = XLSX.utils.book_new();
        const wsData = [];

        // Header untuk Excel
        const header = ["Tanggal", "Nama Komponen", "Total"];
        wsData.push(header);

        // Mengisi data berdasarkan lokasi (SMT 1-4 atau semua)
        const totalData = {};

        for (const mesin in historyData) {
            if (location === 'all' || mesin === location) {
                for (const komponen in historyData[mesin]) {
                    if (!totalData[komponen]) {
                        totalData[komponen] = { total: 0, tanggal: '' };
                    }

                    historyData[mesin][komponen].forEach(data => {
                        totalData[komponen].total += data.Hasil;
                        totalData[komponen].tanggal = data.Tanggal; // Assuming all dates are the same for simplicity
                    });
                }
            }
        }

        // Mengisi data ke dalam wsData
        for (const komponen in totalData) {
            const row = [
                totalData[komponen].tanggal,
                komponen,
                totalData[komponen].total
            ];
            wsData.push(row);
        }

        // Membuat worksheet dari data
        const ws = XLSX.utils.aoa_to_sheet(wsData);

        // Mengatur style untuk header (bold dan alignment)
        const headerStyle = {
            font: { bold: true },
            alignment: { horizontal: 'center' }
        };
        for (let col = 0; col < header.length; col++) {
            const cellAddress = XLSX.utils.encode_cell({ r: 0, c: col });
            if (!ws[cellAddress].s) ws[cellAddress].s = {};
            Object.assign(ws[cellAddress].s, headerStyle);
        }

        // Menambahkan border ke semua sel
        const range = XLSX.utils.decode_range(ws['!ref']);
        for (let row = range.s.r; row <= range.e.r; row++) {
            for (let col = range.s.c; col <= range.e.c; col++) {
                const cellAddress = XLSX.utils.encode_cell({ r: row, c: col });
                if (!ws[cellAddress].s) ws[cellAddress].s = {};
                ws[cellAddress].s.border = {
                    top: { style: 'thin' },
                    bottom: { style: 'thin' },
                    left: { style: 'thin' },
                    right: { style: 'thin' }
                };
            }
        }

        // Menambahkan worksheet ke workbook
        XLSX.utils.book_append_sheet(wb, ws, "Total Komponen");

        // Menyimpan file Excel
        const fileName = location === 'all' ? 'Total_Semua_SMT.xlsx' : `Total_SMT_${location.split(' ')[1]}.xlsx`;
        XLSX.writeFile(wb, fileName);
    }


        function resetData() {
            if (confirm('Apakah Anda yakin ingin mereset semua data?')) {
                localStorage.removeItem('tableData');
                localStorage.removeItem('komponenTotal');
                localStorage.removeItem('historyData');
                tableData = {};
                komponenTotal = {};
                historyData = {
                    'SMT 1': {},
                    'SMT 2': {},
                    'SMT 3': {},
                    'RACK': {}, // Ganti SMT 4 menjadi RACK
                };
                renderTable();
                updateTotal();
                renderTableRiwayat();
                alert('Data telah direset.');
            }
        }
    </script>
</body>
</html>
